/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t={d:(r,o)=>{for(var i in o)t.o(o,i)&&!t.o(r,i)&&Object.defineProperty(r,i,{enumerable:!0,get:o[i]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,l,c,u=[],p=!0,d=!1;try{if(l=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=l.call(o)).done)&&(u.push(i.value),u.length!==r);p=!0);}catch(t){d=!0,a=t}finally{try{if(!p&&null!=o.return&&(c=o.return(),Object(c)!==c))return}finally{if(d)throw a}}return u}}(t,r)||function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _arrayLikeToArray(t,r)}(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function registerSettings(){!function registerSettingsArray(t){for(var r=0,o=Object.entries(t);r<o.length;r++){var i=_slicedToArray(o[r],2),a=i[0],l=i[1];l.name||(l.name="".concat(B,".settings.").concat(a,".name")),l.hint||(l.hint="".concat(B,".settings.").concat(a,".hint")),game.settings.register(B,a,l)}}({})}function propagator_typeof(t){return propagator_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},propagator_typeof(t)}function _createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function propagator_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return propagator_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return propagator_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return c=t.done,t},e:function e(t){u=!0,l=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw l}}}}function propagator_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,l=void 0,l=function _toPrimitive(t,r){if("object"!==propagator_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==propagator_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===propagator_typeof(l)?l:String(l)),i)}var a,l}t.d({},{c:()=>B});var r=function(){function Propagator(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Propagator)}return function _createClass(t,r,o){return r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(Propagator,null,[{key:"getFreePosition",value:function getFreePosition(t,r){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=canvas.grid.getCenter(r.x,r.y);r={x:i[0],y:i[1]};var a,l=Propagator.generatePositions(r),c=_createForOfIteratorHelper(l);try{for(c.s();!(a=c.n()).done;){var u=a.value;if(Propagator.canFit(t,u,l[0],o))return u}}catch(t){c.e(t)}finally{c.f()}}},{key:"generatePositions",value:function generatePositions(t){for(var r=[canvas.grid.getSnappedPosition(t.x-1,t.y-1)],o=canvas.scene.dimensions.size;o<10*canvas.scene.dimensions.size;o+=canvas.scene.dimensions.size)for(var i=0;i<2*Math.PI;i+=Math.PI/(4*o/canvas.scene.dimensions.size)){var a=canvas.grid.getTopLeft(t.x+o*Math.cos(i),t.y+o*Math.sin(i));r.push({x:a[0],y:a[1]})}return r}},{key:"isFree",value:function isFree(t){var r,o=_createForOfIteratorHelper(canvas.tokens.placeables);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(new PIXI.Rectangle(i.document.x,i.document.y,i.document.width*canvas.scene.dimensions.size,i.document.height*canvas.scene.dimensions.size).contains(t.x,t.y))return!1}}catch(t){o.e(t)}finally{o.f()}return!0}},{key:"canFit",value:function canFit(t,r,o,i){for(var a,l,c=0;c<t.width;c++)for(var u=0;u<t.height;u++){var p=r.x+u*canvas.scene.dimensions.size,d=r.y+c*canvas.scene.dimensions.size;if(!Propagator.isFree({x:p,y:d}))return!1}var h=null!==(a=null===(l=CONFIG.Canvas.polygonBackends.move.testCollision(o,{x:r.x+t.width/2,y:r.y+t.height/2},{type:"move"}))||void 0===l?void 0:l.length)&&void 0!==a?a:0;return!i||!h}}]),Propagator}();function templatePreview_typeof(t){return templatePreview_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},templatePreview_typeof(t)}function templatePreview_regeneratorRuntime(){templatePreview_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(values([])));v&&v!==r&&o.call(v,l)&&(d=v);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==templatePreview_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(y,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(y),define(y,u,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function templatePreview_asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function templatePreview_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){templatePreview_asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){templatePreview_asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function templatePreview_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,l=void 0,l=function templatePreview_toPrimitive(t,r){if("object"!==templatePreview_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==templatePreview_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===templatePreview_typeof(l)?l:String(l)),i)}var a,l}function _classPrivateMethodInitSpec(t,r){!function _checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,r),r.add(t)}function _classPrivateMethodGet(t,r,o){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var o=new WeakSet,i=new WeakSet,a=function(){function TemplatePreview(t,r){var a=this,l=r.origin,c=r.range;!function templatePreview_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,TemplatePreview),_classPrivateMethodInitSpec(this,i),_classPrivateMethodInitSpec(this,o),this.document=t,this.resolve=null,this.promise=new Promise((function(t){return a.resolve=t})),this.origin=l,this.range=c,this.isEvenDistance=this.document.distance/canvas.scene.dimensions.distance%2==0,this.range&&(this.range=c*canvas.scene.dimensions.distancePixels)}var t,r,a;return function templatePreview_createClass(t,r,o){return r&&templatePreview_defineProperties(t.prototype,r),o&&templatePreview_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(TemplatePreview,[{key:"activateListeners",value:function activateListeners(){this._onMoveFn=_classPrivateMethodGet(this,o,_onMove2).bind(this),this._onMouseUpFn=_classPrivateMethodGet(this,i,_onMouseUp2).bind(this),document.addEventListener("mousemove",this._onMoveFn),document.addEventListener("mouseup",this._onMouseUpFn)}},{key:"drawPreview",value:(a=templatePreview_asyncToGenerator(templatePreview_regeneratorRuntime().mark((function _callee(){var t,r,o,i,a,l,c,u,p;return templatePreview_regeneratorRuntime().wrap((function _callee$(d){for(;;)switch(d.prev=d.next){case 0:if((t=new PIXI.Container).alpha=0,r=new PIXI.Graphics,o=this.document.fillColor,i=this.document.borderColor,r.beginFill(o,.25),r.drawCircle(0,0,this.document.distance*canvas.dimensions.distancePixels/2),r.endFill(),!this.document.texture){d.next=13;break}return d.next=11,loadTexture(this.document.texture);case 11:(a=d.sent)&&(l=a.width,c=a.height,u=this.document.distance*canvas.dimensions.distancePixels,(p=new PIXI.Matrix).translate(-l/2,-c/2),p.scale(u/l,u/c),r.beginTextureFill({texture:a,matrix:p}),r.drawCircle(0,0,this.document.distance*canvas.dimensions.distancePixels/2),r.endFill());case 13:return r.lineStyle(1,i,1),r.drawCircle(0,0,this.document.distance*canvas.dimensions.distancePixels/2),t.addChild(r),this.previewObject=t,canvas.interface.grid.addChild(t),CanvasAnimation.animate([{parent:t,attribute:"alpha",from:0,to:1}],{duration:200,easing:"easeInCircle"}),this.activateListeners(),this.drawRangePreview(),d.abrupt("return",this.promise);case 22:case"end":return d.stop()}}),_callee,this)}))),function drawPreview(){return a.apply(this,arguments)})},{key:"drawRangePreview",value:(r=templatePreview_asyncToGenerator(templatePreview_regeneratorRuntime().mark((function _callee2(){var t,r,o,i;return templatePreview_regeneratorRuntime().wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:if(this.range&&this.origin){a.next=2;break}return a.abrupt("return");case 2:(t=new PIXI.Container).alpha=0,r=new PIXI.Graphics,o=this.document.fillColor,i=this.document.borderColor,r.beginFill(o,.15),r.drawCircle(0,0,this.range),r.endFill(),r.lineStyle(1,i,1),r.drawCircle(0,0,this.range),t.addChild(r),this.previewRangeObject=t,canvas.interface.grid.addChild(t),CanvasAnimation.animate([{parent:t,attribute:"alpha",from:0,to:1}],{duration:200,easing:"easeInCircle"}),t.x=this.origin.x,t.y=this.origin.y;case 18:case"end":return a.stop()}}),_callee2,this)}))),function drawRangePreview(){return r.apply(this,arguments)})},{key:"cleanup",value:(t=templatePreview_asyncToGenerator(templatePreview_regeneratorRuntime().mark((function _callee3(){var t=this;return templatePreview_regeneratorRuntime().wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:document.removeEventListener("mousemove",this._onMoveFn),document.removeEventListener("mouseup",this._onMouseUpFn),CanvasAnimation.animate([{parent:this.previewObject,attribute:"alpha",to:0}],{duration:200,easing:"easeOutCircle"}).then((function(){t.previewObject.removeFromParent(),t.previewObject.destroy(!0)})),this.previewRangeObject&&CanvasAnimation.animate([{parent:this.previewRangeObject,attribute:"alpha",to:0}],{duration:200,easing:"easeOutCircle"}).then((function(){t.previewRangeObject.removeFromParent(),t.previewRangeObject.destroy(!0)}));case 4:case"end":return r.stop()}}),_callee3,this)}))),function cleanup(){return t.apply(this,arguments)})}]),TemplatePreview}();function _onMove2(t){var r=canvas.canvasCoordinatesFromClient({x:t.clientX,y:t.clientY});if(r=[r.x,r.y],this.isEvenDistance){var o=canvas.grid.getSnappedPosition(r[0],r[1]);r=[o.x,o.y]}else r=canvas.grid.getCenter(r[0],r[1]);this.document.updateSource({x:r[0],y:r[1]}),this.previewObject.x=r[0],this.previewObject.y=r[1]}function _onMouseUp2(t){var r=2===t.button,o=0===t.button;(r||o)&&(this.cleanup(),this.resolve(o?this.document:null))}function portal_typeof(t){return portal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},portal_typeof(t)}function ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(o),!0).forEach((function(r){_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function _defineProperty(t,r,o){return(r=portal_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function portal_slicedToArray(t,r){return function portal_arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function portal_iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,l,c,u=[],p=!0,d=!1;try{if(l=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=l.call(o)).done)&&(u.push(i.value),u.length!==r);p=!0);}catch(t){d=!0,a=t}finally{try{if(!p&&null!=o.return&&(c=o.return(),Object(c)!==c))return}finally{if(d)throw a}}return u}}(t,r)||portal_unsupportedIterableToArray(t,r)||function portal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function portal_createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=portal_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return c=t.done,t},e:function e(t){u=!0,l=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw l}}}}function portal_unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return portal_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?portal_arrayLikeToArray(t,r):void 0}}function portal_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function portal_regeneratorRuntime(){portal_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(values([])));v&&v!==r&&o.call(v,l)&&(d=v);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==portal_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(y,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(y),define(y,u,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function portal_asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function portal_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){portal_asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){portal_asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function portal_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,portal_toPropertyKey(i.key),i)}}function portal_toPropertyKey(t){var r=function portal_toPrimitive(t,r){if("object"!==portal_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==portal_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===portal_typeof(r)?r:String(r)}function portal_classPrivateMethodInitSpec(t,r){portal_checkPrivateRedeclaration(t,r),r.add(t)}function _classPrivateFieldInitSpec(t,r,o){portal_checkPrivateRedeclaration(t,r),r.set(t,o)}function portal_checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function portal_classPrivateMethodGet(t,r,o){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function _classPrivateFieldGet(t,r){return function _classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,_classExtractFieldDescriptor(t,r,"get"))}function _classPrivateFieldSet(t,r,o){return function _classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,_classExtractFieldDescriptor(t,r,"set"),o),o}function _classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}var l={origin:null,distance:null,texture:""},c=new WeakMap,u=new WeakMap,p=new WeakMap,d=new WeakMap,h=new WeakMap,v=new WeakMap,y=new WeakSet,m=new WeakSet,g=new WeakSet,_=new WeakSet,b=new WeakSet,w=function(){function Portal(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function portal_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Portal),portal_classPrivateMethodInitSpec(this,b),portal_classPrivateMethodInitSpec(this,_),portal_classPrivateMethodInitSpec(this,g),portal_classPrivateMethodInitSpec(this,m),portal_classPrivateMethodInitSpec(this,y),_classPrivateFieldInitSpec(this,c,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,u,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,p,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,d,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,h,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,v,{writable:!0,value:!1}),_classPrivateFieldSet(this,c,foundry.utils.mergeObject(foundry.utils.deepClone(l),t))}var t,o,i,a,w;return function portal_createClass(t,r,o){return r&&portal_defineProperties(t.prototype,r),o&&portal_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(Portal,[{key:"template",get:function get(){return _classPrivateFieldGet(this,h)}},{key:"tokens",get:function get(){return _classPrivateFieldGet(this,u)}},{key:"origin",value:function origin(t){var r;(t instanceof Token||t instanceof TokenDocument)&&(_classPrivateFieldGet(this,c).teleportTarget=null!==(r=t.document)&&void 0!==r?r:t);return t&&Number.isFinite(t.x)&&Number.isFinite(t.y)?(t.center?_classPrivateFieldGet(this,c).origin={x:t.center.x,y:t.center.y,elevation:t.document.elevation}:_classPrivateFieldGet(this,c).origin={x:t.x,y:t.y,elevation:t.elevation},this):(ui.notifications.error("".concat(B,".ERR.InvalidOrigin"),{localize:!0}),this)}},{key:"radius",get:function get(){return _classPrivateFieldGet(this,c).radius}},{key:"texture",value:function texture(t){return"string"==typeof t?_classPrivateFieldGet(this,c).texture=t:ui.notifications.error("".concat(B,".ERR.InvalidTexture"),{localize:!0}),this}},{key:"addCreature",value:function addCreature(t){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.updateData,a=void 0===i?null:i,l=o.count,c=void 0===l?1:l;if(Array.isArray(t))return t.forEach((function(t){return r.addCreature(t)})),this;var h=null;return t instanceof Token&&(h=t.document.toObject()),t instanceof TokenDocument&&(h=t.toObject()),(t instanceof Actor||"string"==typeof t)&&(h=portal_classPrivateMethodGet(this,m,_processAsyncCreature2).call(this,t)),h||ui.notifications.error("".concat(B,".ERR.NoTokenData"),{localize:!0}),_classPrivateFieldGet(this,u).push(h),_classPrivateFieldGet(this,p).push(a),_classPrivateFieldGet(this,d).push(c),this}},{key:"size",value:function size(t){return Number.isFinite(t)?_classPrivateFieldGet(this,c).distance=t:ui.notifications.error("".concat(B,".ERR.InvalidNumber"),{localize:!0}),this}},{key:"color",value:function color(t){return _classPrivateFieldGet(this,c).color=t,this}},{key:"range",value:function range(t){return Number.isFinite(t)?_classPrivateFieldGet(this,c).range=t:ui.notifications.error("".concat(B,".ERR.InvalidNumber"),{localize:!0}),this}},{key:"pick",value:(w=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee(){var t,r,o,i,a,l,u,p=arguments;return portal_regeneratorRuntime().wrap((function _callee$(d){for(;;)switch(d.prev=d.next){case 0:return o=p.length>0&&void 0!==p[0]?p[0]:{},d.next=3,portal_classPrivateMethodGet(this,g,_preValidateAndProcessData2).call(this);case 3:return d.next=5,portal_classPrivateMethodGet(this,b,_getTemplateData2).call(this);case 5:if(!(i=d.sent)){d.next=15;break}if(!_classPrivateFieldGet(this,c).origin||!_classPrivateFieldGet(this,c).range){d.next=12;break}if(!(canvas.grid.measureDistance(_classPrivateFieldGet(this,c).origin,{x:i.x,y:i.y})>_classPrivateFieldGet(this,c).range)){d.next=12;break}return ui.notifications.error("".concat(B,".ERR.OutOfRange"),{localize:!0}),d.abrupt("return",this.pick(o));case 12:_classPrivateFieldSet(this,h,i),d.next=16;break;case 15:return d.abrupt("return",!1);case 16:return a=_classPrivateFieldGet(this,h).x,l=_classPrivateFieldGet(this,h).y,u=null!==(t=null!==(r=this.origin.elevation)&&void 0!==r?r:_classPrivateFieldGet(this,h).elevation)&&void 0!==t?t:0,d.abrupt("return",{x:a,y:l,elevation:u});case 20:case"end":return d.stop()}}),_callee,this)}))),function pick(){return w.apply(this,arguments)})},{key:"spawn",value:(a=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee2(){var t,o,i,a,l,c,v,y,m,b,w,P,x,k=arguments;return portal_regeneratorRuntime().wrap((function _callee2$(G){for(;;)switch(G.prev=G.next){case 0:return t=k.length>0&&void 0!==k[0]?k[0]:{},(Array.isArray(t)||"string"==typeof t)&&this.addCreature(t),G.next=4,portal_classPrivateMethodGet(this,g,_preValidateAndProcessData2).call(this);case 4:if(_classPrivateFieldGet(this,h)){G.next=13;break}return G.next=7,this.pick(t);case 7:if(i=G.sent){G.next=10;break}return G.abrupt("return",!1);case 10:o=i,G.next=14;break;case 13:o={x:_classPrivateFieldGet(this,h).x,y:_classPrivateFieldGet(this,h).y,elevation:null!==(a=_classPrivateFieldGet(this,h).elevation)&&void 0!==a?a:0};case 14:l=[],c=0;case 16:if(!(c<_classPrivateFieldGet(this,u).length)){G.next=39;break}return v=new Roll(_classPrivateFieldGet(this,d)[c].toString()),G.next=20,v.evaluate();case 20:y=G.sent.total,m=_classPrivateFieldGet(this,u)[c],b={x:o.x-m.width/2*canvas.scene.dimensions.size,y:o.y-m.height/2*canvas.scene.dimensions.size,elevation:o.elevation},w=0;case 24:if(!(w<y)){G.next=36;break}return P=r.getFreePosition(m,b,!0),m.updateSource({x:P.x,y:P.y,elevation:b.elevation}),G.next=29,canvas.scene.createEmbeddedDocuments("Token",[m]);case 29:return x=G.sent[0],G.next=32,portal_classPrivateMethodGet(this,_,_processPostSpawnUpdate2).call(this,x,_classPrivateFieldGet(this,p)[c]);case 32:l.push(x);case 33:w++,G.next=24;break;case 36:c++,G.next=16;break;case 39:return G.abrupt("return",l);case 40:case"end":return G.stop()}}),_callee2,this)}))),function spawn(){return a.apply(this,arguments)})},{key:"dialog",value:(i=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee3(){var t,r,o,i,a,l,c,h,v,y=this,m=arguments;return portal_regeneratorRuntime().wrap((function _callee3$(_){for(;;)switch(_.prev=_.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{spawn:!0,multipleChoice:!1,title:"".concat(B,".DIALOG.Title")},_.next=3,portal_classPrivateMethodGet(this,g,_preValidateAndProcessData2).call(this);case 3:return r=_classPrivateFieldGet(this,u).map((function(t,r){return{token:t,count:_classPrivateFieldGet(y,d)[r],index:r}})),_.next=6,renderTemplate("modules/portal-lib/templates/dialog.hbs",{dialogData:r});case 6:return o=_.sent,_.next=9,Dialog.prompt({title:game.i18n.localize(t.title),content:o,close:function close(){return!1},callback:function callback(t){return t},render:function render(r){var o=r[0];o.querySelectorAll("li").forEach((function(r,i){0===i&&r.classList.add("selected"),r.addEventListener("click",(function(i){t.multipleChoice||o.querySelectorAll("li").forEach((function(t){return t.classList.remove("selected")})),r.classList.toggle("selected")}))}))}});case 9:if(i=_.sent){_.next=12;break}return _.abrupt("return",!1);case 12:if(a=i[0].querySelector("ul"),l=a.querySelectorAll("li.selected"),c=[],h=[],v=[],l.forEach((function(t){var r=parseInt(t.dataset.index),o=_classPrivateFieldGet(y,u)[r],i=t.querySelector("input").value,a=_classPrivateFieldGet(y,p)[r];c.push(o),h.push(i),v.push(a)})),_classPrivateFieldSet(this,u,c),_classPrivateFieldSet(this,d,h),_classPrivateFieldSet(this,p,v),!t.spawn){_.next=27;break}return _.next=24,this.spawn();case 24:return _.abrupt("return",_.sent);case 27:return _.abrupt("return",this);case 28:case"end":return _.stop()}}),_callee3,this)}))),function dialog(){return i.apply(this,arguments)})},{key:"teleport",value:(o=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee4(){var t,r,o,i,a,l,u=arguments;return portal_regeneratorRuntime().wrap((function _callee4$(p){for(;;)switch(p.prev=p.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},r=_classPrivateFieldGet(this,c).teleportTarget){p.next=5;break}return ui.notifications.error("".concat(B,".ERR.NoTeleportTarget"),{localize:!0}),p.abrupt("return",!1);case 5:return p.next=7,portal_classPrivateMethodGet(this,g,_preValidateAndProcessData2).call(this);case 7:if(_classPrivateFieldGet(this,h)){p.next=14;break}return p.next=10,this.pick(t);case 10:if(i=p.sent){p.next=13;break}return p.abrupt("return",!1);case 13:o=i;case 14:return a=r.object,l=a.mesh.alpha,p.next=18,CanvasAnimation.animate([{parent:a.mesh,attribute:"alpha",to:0}],{duration:300,easing:"easeOutCircle"});case 18:return p.next=20,r.update({x:o.x,y:o.y,elevation:o.elevation},{animate:!1});case 20:return p.next=22,CanvasAnimation.animate([{parent:a.mesh,attribute:"alpha",from:0,to:l}],{duration:300,easing:"easeInCircle"});case 22:return p.abrupt("return",this);case 23:case"end":return p.stop()}}),_callee4,this)}))),function teleport(){return o.apply(this,arguments)})}],[{key:"spawn",value:(t=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee5(){var t,r,o=arguments;return portal_regeneratorRuntime().wrap((function _callee5$(i){for(;;)switch(i.prev=i.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},(r=new Portal).addCreature(t),i.next=5,r.spawn();case 5:return i.abrupt("return",i.sent);case 6:case"end":return i.stop()}}),_callee5)}))),function spawn(){return t.apply(this,arguments)})}]),Portal}();function _resolveTokenData2(){return _resolveTokenData3.apply(this,arguments)}function _resolveTokenData3(){return(_resolveTokenData3=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee6(){var t,r,o,i,a,l,c;return portal_regeneratorRuntime().wrap((function _callee6$(d){for(;;)switch(d.prev=d.next){case 0:t=[],r=portal_createForOfIteratorHelper(_classPrivateFieldGet(this,u)),d.prev=2,r.s();case 4:if((o=r.n()).done){d.next=13;break}return i=o.value,d.t0=t,d.next=9,i;case 9:d.t1=d.sent,d.t0.push.call(d.t0,d.t1);case 11:d.next=4;break;case 13:d.next=18;break;case 15:d.prev=15,d.t2=d.catch(2),r.e(d.t2);case 18:return d.prev=18,r.f(),d.finish(18);case 21:for(_classPrivateFieldSet(this,u,t.map((function(t){return new TokenDocument(t)}))),a=0;a<_classPrivateFieldGet(this,u).length;a++)c=_classPrivateFieldGet(this,u)[a],null!==(l=_classPrivateFieldGet(this,p)[a])&&void 0!==l&&l.token&&c.updateSource(_classPrivateFieldGet(this,p)[a].token);return d.abrupt("return",this);case 24:case"end":return d.stop()}}),_callee6,this,[[2,15,18,21]])})))).apply(this,arguments)}function _processAsyncCreature2(t){return _processAsyncCreature3.apply(this,arguments)}function _processAsyncCreature3(){return(_processAsyncCreature3=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee7(t){var r;return portal_regeneratorRuntime().wrap((function _callee7$(o){for(;;)switch(o.prev=o.next){case 0:if(r=t,"string"!=typeof t){o.next=5;break}return o.next=4,fromUuid(t);case 4:t=o.sent;case 5:if(t||(t=game.actors.getName(r)),t){o.next=8;break}return o.abrupt("return",null);case 8:if(!(t instanceof Actor)){o.next=12;break}return o.next=11,t.getTokenDocument();case 11:return o.abrupt("return",o.sent);case 12:if(!(t instanceof TokenDocument)){o.next=14;break}return o.abrupt("return",t.toObject());case 14:if(!(t instanceof Token)){o.next=16;break}return o.abrupt("return",t.document.toObject());case 16:return o.abrupt("return",null);case 17:case"end":return o.stop()}}),_callee7)})))).apply(this,arguments)}function _preValidateAndProcessData2(){return _preValidateAndProcessData3.apply(this,arguments)}function _preValidateAndProcessData3(){return(_preValidateAndProcessData3=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee8(){var t,r;return portal_regeneratorRuntime().wrap((function _callee8$(o){for(;;)switch(o.prev=o.next){case 0:if(!_classPrivateFieldGet(this,v)){o.next=2;break}return o.abrupt("return",this);case 2:return _classPrivateFieldSet(this,v,!0),o.next=5,portal_classPrivateMethodGet(this,y,_resolveTokenData2).call(this);case 5:return Number.isFinite(_classPrivateFieldGet(this,c).distance)||(t=_classPrivateFieldGet(this,u)[0],r=t?Math.max(t.width,t.height):1,_classPrivateFieldGet(this,c).distance=r*canvas.scene.dimensions.distance),"string"!=typeof _classPrivateFieldGet(this,c).color&&(_classPrivateFieldGet(this,c).color=game.user.color.toString()),o.abrupt("return",this);case 8:case"end":return o.stop()}}),_callee8,this)})))).apply(this,arguments)}function _processPostSpawnUpdate2(t,r){return _processPostSpawnUpdate3.apply(this,arguments)}function _processPostSpawnUpdate3(){return(_processPostSpawnUpdate3=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee9(t,r){var o,i,a,l;return portal_regeneratorRuntime().wrap((function _callee9$(c){for(;;)switch(c.prev=c.next){case 0:if(r){c.next=2;break}return c.abrupt("return");case 2:if(o=t.actor){c.next=5;break}return c.abrupt("return");case 5:if(!r.actor){c.next=8;break}return c.next=8,t.actor.update(r.actor);case 8:if(!r.embedded){c.next=16;break}i=portal_regeneratorRuntime().mark((function _loop(){var t,r,i,c,u;return portal_regeneratorRuntime().wrap((function _loop$(p){for(;;)switch(p.prev=p.next){case 0:return t=portal_slicedToArray(l[a],2),r=t[0],i=t[1],c=o.getEmbeddedCollection(r),u=[],c.forEach((function(t){var r,o=null!==(r=i[t.id])&&void 0!==r?r:i[t.name];o&&u.push(_objectSpread({_id:t.id},o))})),p.next=6,c.update(u);case 6:case"end":return p.stop()}}),_loop)})),a=0,l=Object.entries(r.embedded);case 11:if(!(a<l.length)){c.next=16;break}return c.delegateYield(i(),"t0",13);case 13:a++,c.next=11;break;case 16:case"end":return c.stop()}}),_callee9)})))).apply(this,arguments)}function _getTemplateData2(){return _getTemplateData3.apply(this,arguments)}function _getTemplateData3(){return(_getTemplateData3=portal_asyncToGenerator(portal_regeneratorRuntime().mark((function _callee10(){var t,r,o,i,l;return portal_regeneratorRuntime().wrap((function _callee10$(u){for(;;)switch(u.prev=u.next){case 0:if((r=new MeasuredTemplateDocument).updateSource({distance:_classPrivateFieldGet(this,c).distance,fillColor:_classPrivateFieldGet(this,c).color,texture:_classPrivateFieldGet(this,c).texture}),null===(t=game.Levels3DPreview)||void 0===t||!t._active){u.next=13;break}return r.updateSource({distance:_classPrivateFieldGet(this,c).distance/2}),u.next=6,game.Levels3DPreview.CONFIG.entityClass.Template3D.drawPreview({document:r},!1);case 6:return o=u.sent,i=canvas.grid.getCenter(o.x,o.y),o.x=i[0],o.y=i[1],u.abrupt("return",new MeasuredTemplateDocument(o));case 13:return l=new a(r,{origin:_classPrivateFieldGet(this,c).origin,range:_classPrivateFieldGet(this,c).range}),u.next=16,l.drawPreview();case 16:return u.abrupt("return",u.sent);case 17:case"end":return u.stop()}}),_callee10,this)})))).apply(this,arguments)}function formHelper_typeof(t){return formHelper_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},formHelper_typeof(t)}function formHelper_regeneratorRuntime(){formHelper_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(values([])));v&&v!==r&&o.call(v,l)&&(d=v);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==formHelper_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(y,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(y),define(y,u,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return formHelper_arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||formHelper_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function formHelper_asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function formHelper_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){formHelper_asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){formHelper_asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function formHelper_unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return formHelper_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?formHelper_arrayLikeToArray(t,r):void 0}}function formHelper_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function formHelper_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,formHelper_toPropertyKey(i.key),i)}}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},_get.apply(this,arguments)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},_setPrototypeOf(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function _possibleConstructorReturn(t,r){if(r&&("object"===formHelper_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}(this,o)}}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function formHelper_defineProperty(t,r,o){return(r=formHelper_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function formHelper_toPropertyKey(t){var r=function formHelper_toPrimitive(t,r){if("object"!==formHelper_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==formHelper_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===formHelper_typeof(r)?r:String(r)}function formHelper_classPrivateFieldInitSpec(t,r,o){formHelper_checkPrivateRedeclaration(t,r),r.set(t,o)}function formHelper_checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function formHelper_classPrivateFieldGet(t,r){return function formHelper_classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,formHelper_classExtractFieldDescriptor(t,r,"get"))}function formHelper_classPrivateMethodGet(t,r,o){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function formHelper_classPrivateFieldSet(t,r,o){return function formHelper_classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,formHelper_classExtractFieldDescriptor(t,r,"set"),o),o}function formHelper_classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}var P={tabs:[{id:"basic",group:"sheet",icon:"fa-solid fa-lightbulb",label:"AMBIENT_LIGHT.SECTIONS.BASIC",fields:[{field:new foundry.data.fields.StringField,name:"test",label:"Test",type:"text",value:"test",hint:"this is a hint"},{fieldset:!0,legend:"Test",fields:[{field:new foundry.data.fields.StringField,name:"test2",label:"Test 2",type:"text",value:"test",hint:"this is a hint"},{field:new foundry.data.fields.StringField,name:"test3",label:"Test 3",type:"text",value:"test",hint:"this is a hint"}]}]},{id:"animation",group:"sheet",icon:"fa-solid fa-play",label:"AMBIENT_LIGHT.SECTIONS.ANIMATION"},{id:"advanced",group:"sheet",icon:"fa-solid fa-cogs",label:"AMBIENT_LIGHT.SECTIONS.ADVANCED"}],fields:[{field:new foundry.data.fields.StringField,name:"test4",label:"Test 2",type:"text",value:"test",hint:"this is a hint"},{field:new foundry.data.fields.StringField,name:"test6",label:"Test 3",type:"text",value:"test",hint:"this is a hint"}],buttons:[{action:"test",type:"button",icon:"fas fa-cube",label:"TEST",callback:function callback(t,r){return console.log(t,r)}}]},x=new WeakMap,k=new WeakMap,G=new WeakSet,S=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&_setPrototypeOf(t,r)}(FormHelper,foundry.applications.api.HandlebarsApplicationMixin(foundry.applications.api.ApplicationV2));var r,o=_createSuper(FormHelper);function FormHelper(t){var r,i;!function formHelper_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,FormHelper),console.log(t),t=null!==(r=t)&&void 0!==r?r:P;var a={};return t.buttons.forEach((function(t){return a[t.action]=t.callback})),function formHelper_classPrivateMethodInitSpec(t,r){formHelper_checkPrivateRedeclaration(t,r),r.add(t)}(_assertThisInitialized(i=o.call(this,{actions:a})),G),formHelper_classPrivateFieldInitSpec(_assertThisInitialized(i),x,{writable:!0,value:void 0}),formHelper_classPrivateFieldInitSpec(_assertThisInitialized(i),k,{writable:!0,value:void 0}),i.resolve,i.reject,i.promise=new Promise((function(t,r){i.resolve=t,i.reject=r})),i._title=t.options.title,i.processFormStructure(t),i}return function formHelper_createClass(t,r,o){return r&&formHelper_defineProperties(t.prototype,r),o&&formHelper_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(FormHelper,[{key:"title",get:function get(){return this._title}},{key:"processFormStructure",value:function processFormStructure(t){var r,o,i;if(null!==(r=t.tabs)&&void 0!==r&&r.length){this.__tabs={},t.tabs.find((function(t){return t.active}))||(t.tabs[0].active=!0);var a,l=function formHelper_createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=formHelper_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return c=t.done,t},e:function e(t){u=!0,l=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw l}}}}(t.tabs);try{for(l.s();!(a=l.n()).done;){var c,u,p=a.value;this.__tabs[p.id]={id:p.id,group:p.group,icon:p.icon,label:p.label,active:null!==(c=p.active)&&void 0!==c&&c,fields:null!==(u=p.fields)&&void 0!==u?u:[]}}}catch(t){l.e(t)}finally{l.f()}}formHelper_classPrivateFieldSet(this,x,null!==(o=t.fields)&&void 0!==o?o:[]),formHelper_classPrivateFieldSet(this,k,null!==(i=t.buttons)&&void 0!==i?i:[])}},{key:"_onClose",value:function _onClose(t){_get(_getPrototypeOf(FormHelper.prototype),"_onClose",this).call(this,t),this.promise.resolved||this.resolve(!1)}},{key:"_prepareContext",value:(r=formHelper_asyncToGenerator(formHelper_regeneratorRuntime().mark((function _callee(t){return formHelper_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{tabs:formHelper_classPrivateMethodGet(this,G,_getTabs2).call(this),fields:formHelper_classPrivateFieldGet(this,x),buttons:[].concat(_toConsumableArray(formHelper_classPrivateFieldGet(this,k).filter((function(t){return"submit"!==t.type}))),_toConsumableArray(formHelper_classPrivateFieldGet(this,k).filter((function(t){return"submit"===t.type}))))});case 1:case"end":return t.stop()}}),_callee,this)}))),function _prepareContext(t){return r.apply(this,arguments)})},{key:"changeTab",value:function changeTab(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];(t=_get(_getPrototypeOf(FormHelper.prototype),"changeTab",this)).call.apply(t,[this].concat(o))}},{key:"_onChangeForm",value:function _onChangeForm(t,r){_get(_getPrototypeOf(FormHelper.prototype),"_onChangeForm",this).call(this,t,r);new FormDataExtended(this.element)}}]),FormHelper}();function _getTabs2(){for(var t,r=null!==(t=this.__tabs)&&void 0!==t?t:{},o=0,i=Object.values(r);o<i.length;o++){var a=i[o];if(a.cssClass=a.active?"active":"",a.active)break}return r}function _onSubmit3(){return(_onSubmit3=formHelper_asyncToGenerator(formHelper_regeneratorRuntime().mark((function _callee2(t,r,o){var i;return formHelper_regeneratorRuntime().wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:i=foundry.utils.expandObject(o.object),this.resolve(i);case 2:case"end":return t.stop()}}),_callee2,this)})))).apply(this,arguments)}function formBuilder_typeof(t){return formBuilder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},formBuilder_typeof(t)}function formBuilder_regeneratorRuntime(){formBuilder_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(values([])));v&&v!==r&&o.call(v,l)&&(d=v);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==formBuilder_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(y,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(y),define(y,u,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function formBuilder_asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function formBuilder_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,l=void 0,l=function formBuilder_toPrimitive(t,r){if("object"!==formBuilder_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==formBuilder_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===formBuilder_typeof(l)?l:String(l)),i)}var a,l}function formBuilder_classPrivateFieldInitSpec(t,r,o){formBuilder_checkPrivateRedeclaration(t,r),r.set(t,o)}function formBuilder_checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function formBuilder_classPrivateMethodGet(t,r,o){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function formBuilder_classPrivateFieldSet(t,r,o){return function formBuilder_classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,formBuilder_classExtractFieldDescriptor(t,r,"set"),o),o}function formBuilder_classPrivateFieldGet(t,r){return function formBuilder_classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,formBuilder_classExtractFieldDescriptor(t,r,"get"))}function formBuilder_classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}formHelper_defineProperty(S,"DEFAULT_OPTIONS",{classes:["form-helper"],tag:"form",window:{contentClasses:["standard-form"]},position:{width:560,height:"auto"},form:{handler:function _classStaticPrivateMethodGet(t,r,o){return function _classCheckPrivateStaticAccess(t,r){if(t!==r)throw new TypeError("Private static access of wrong provenance")}(t,r),o}(S,S,(function _onSubmit(t,r,o){return _onSubmit3.apply(this,arguments)})),closeOnSubmit:!0},actions:{}}),formHelper_defineProperty(S,"PARTS",{tabs:{template:"templates/generic/tab-navigation.hbs"},genericForm:{template:"modules/portal-lib/templates/genericForm.hbs"},footer:{template:"templates/generic/form-footer.hbs"}});var E=new WeakMap,T=new WeakMap,I=new WeakMap,O=new WeakMap,A=new WeakMap,j=new WeakMap,L=new WeakMap,C=new WeakSet,M=function(){function FormBuilder(){!function formBuilder_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,FormBuilder),function formBuilder_classPrivateMethodInitSpec(t,r){formBuilder_checkPrivateRedeclaration(t,r),r.add(t)}(this,C),formBuilder_classPrivateFieldInitSpec(this,E,{writable:!0,value:[]}),formBuilder_classPrivateFieldInitSpec(this,T,{writable:!0,value:[]}),formBuilder_classPrivateFieldInitSpec(this,I,{writable:!0,value:[]}),formBuilder_classPrivateFieldInitSpec(this,O,{writable:!0,value:{enableSubmit:!0}}),formBuilder_classPrivateFieldInitSpec(this,A,{writable:!0,value:null}),formBuilder_classPrivateFieldInitSpec(this,j,{writable:!0,value:null}),formBuilder_classPrivateFieldInitSpec(this,L,{writable:!0,value:null}),this.submitButton()}var t;return function formBuilder_createClass(t,r,o){return r&&formBuilder_defineProperties(t.prototype,r),o&&formBuilder_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(FormBuilder,[{key:"render",value:(t=function formBuilder_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){formBuilder_asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){formBuilder_asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(formBuilder_regeneratorRuntime().mark((function _callee(){var t;return formBuilder_regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return(t=this.form()).render(!0),r.abrupt("return",t.promise);case 3:case"end":return r.stop()}}),_callee,this)}))),function render(){return t.apply(this,arguments)})},{key:"form",value:function form(){return new S({tabs:formBuilder_classPrivateFieldGet(this,E),fields:formBuilder_classPrivateFieldGet(this,T),buttons:formBuilder_classPrivateFieldGet(this,I),options:formBuilder_classPrivateFieldGet(this,O)})}},{key:"title",value:function title(t){return formBuilder_classPrivateFieldGet(this,O).title=t,this}},{key:"object",value:function object(t){return formBuilder_classPrivateFieldSet(this,L,t),this}},{key:"enableSubmit",value:function enableSubmit(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return formBuilder_classPrivateFieldGet(this,O).enableSubmit=t,this}},{key:"submitButton",value:function submitButton(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.enabled,o=void 0===r||r,i=t.label,a=void 0===i?"Confirm":i,l=t.icon,submitButton={type:"submit",action:"submit",icon:void 0===l?"fa-solid fa-check":l,label:a};return o?formBuilder_classPrivateFieldGet(this,I).push(submitButton):formBuilder_classPrivateFieldSet(this,I,formBuilder_classPrivateFieldGet(this,I).filter((function(t){return"submit"!==t.action}))),this}},{key:"tab",value:function tab(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.id,i=r.group,a=r.icon,l=r.label,c=r.active,u=void 0!==c&&c;if(null!==(t=i)&&void 0!==t||(i="sheet"),!o&&formBuilder_classPrivateFieldGet(this,A))return formBuilder_classPrivateFieldSet(this,A,null),this;if(!o)throw new Error("You must provide an id for the tab");var tab={id:o,group:i,icon:a,label:l,active:u,fields:[]};return formBuilder_classPrivateFieldGet(this,E).push(tab),formBuilder_classPrivateFieldSet(this,A,tab),this}},{key:"fieldset",value:function fieldset(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).legend;if(!t&&formBuilder_classPrivateFieldGet(this,j))return formBuilder_classPrivateFieldSet(this,j,null),this;if(!t)throw new Error("You must provide a legend for the fieldset");var fieldset={legend:t,fieldset:!0,fields:[]};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,fieldset),formBuilder_classPrivateFieldSet(this,j,fieldset),this}},{key:"text",value:function text(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.StringField,name:r,label:o,hint:i,value:a};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,l),this}},{key:"number",value:function number(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l=t.min,c=t.max,u=t.step,p={field:new foundry.data.fields.NumberField,name:r,label:o,hint:i,value:a,min:l,max:c,step:u};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,p),this}},{key:"checkbox",value:function checkbox(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.BooleanField,name:r,label:o,hint:i,value:a};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,l),this}},{key:"color",value:function color(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.ColorField,name:r,label:o,hint:i,value:a};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,l),this}},{key:"file",value:function file(t){var r,o=t.name,i=t.type,a=t.label,l=t.hint,c=t.value;null!==(r=i)&&void 0!==r||(i="imagevideo");var u=R[i],p=new foundry.data.fields.FilePathField({categories:u});p.categories=[i];var d={field:p,name:o,label:a,hint:l,type:i,value:c};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,d),this}},{key:"select",value:function select(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l=t.options,c={field:inferSelectDataType(l)===Number?new foundry.data.fields.NumberField({choices:l}):new foundry.data.fields.StringField({choices:l}),name:r,label:o,hint:i,value:a,options:l};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,c),this}},{key:"multiSelect",value:function multiSelect(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l=t.options,c=inferSelectDataType(l)===Number?new foundry.data.fields.NumberField({choices:l}):new foundry.data.fields.StringField({choices:l}),u={field:new foundry.data.fields.SetField(c),name:r,label:o,hint:i,value:a,options:l};return formBuilder_classPrivateMethodGet(this,C,_addField2).call(this,u),this}},{key:"button",value:function button(t){var r,o=t.label,i=t.action,a=t.icon,l=t.callback;null!==(r=i)&&void 0!==r||(i=foundry.utils.randomID());var button={action:i,type:"button",icon:a,label:o,callback:l};return formBuilder_classPrivateFieldGet(this,I).push(button),this}}]),FormBuilder}();function _addField2(t){if(formBuilder_classPrivateFieldGet(this,L)){var r=foundry.utils.getProperty(formBuilder_classPrivateFieldGet(this,L),t.name);void 0!==r&&(t.value=r)}return formBuilder_classPrivateFieldGet(this,j)?formBuilder_classPrivateFieldGet(this,j).fields.push(t):formBuilder_classPrivateFieldGet(this,A)?formBuilder_classPrivateFieldGet(this,A).fields.push(t):formBuilder_classPrivateFieldGet(this,T).push(t)}var R={imagevideo:["IMAGE","VIDEO"],image:["IMAGE"],video:["VIDEO"],audio:["AUDIO"],font:["FONT"],graphics:["GRAPHICS"]};function inferSelectDataType(t){var r=Object.keys(t);try{if(r.every((function(t){return"number"==typeof JSON.parse(t)})))return Number}catch(t){return String}return String}var B="portal-lib";globalThis.Portal=w,globalThis.FormHelper=S,globalThis.FormBuilder=M,Hooks.on("init",(function(){registerSettings()}))})();
//# sourceMappingURL=index.js.map